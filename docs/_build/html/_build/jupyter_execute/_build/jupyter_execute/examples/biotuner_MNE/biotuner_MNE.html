
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Harmonicity Metrics Computation on MNE Epochs File &#8212; Biotuner 0.0.10 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/example_gallery_styles.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../../../" id="documentation_options" src="../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../_static/doctools.js"></script>
    <script src="../../../../../../_static/thebelab-helper.js"></script>
    <script src="../../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../../_static/copybutton.js"></script>
    <script src="../../../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../../../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Biotuner 0.0.10 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Menu:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../getting_started.html">
   Getting started with Biotuner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../../cite_us.html">
   Cite us
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../../../examples/index.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/biotuner_MNE/biotuner_MNE.html">
     Harmonicity Metrics Computation on MNE Epochs File
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/peaks_extraction/peaks_extraction.html">
     Peaks extraction methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/harmonicity_metrics/harmonicity_metrics.html">
     Harmonicity metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/harmonic_spectrum/harmonic_spectrum.html">
     From Spectral Peaks to Harmonic Spectrum Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/toolbox_paper_notebook/toolbox_paper_notebook.html">
     Biotuner Paper Design and Implementation Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/toolbox_paper_result_notebook/toolbox_paper_result_notebook.html">
     Biotuner Toolbox Paper Results Figures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/scale_construction/scale_construction.html">
     Constructing musical tunings with biosignals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/spectral_chords/spectral_chords.html">
     Deriving spectral chords from biosignals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/rhythm_construction/rhythm_construction.html">
     Constructing euclidian rhythms from biotunings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../../../../examples/phase_amplitude_coupling/phase_amplitude_coupling.html">
     Phase-Amplitude Coupling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../../../../api/index.html">
   API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/biotuner_object.html">
     Biotuner object
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/metrics.html">
     Harmonicity Metrics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/peaks_extraction.html">
     Peaks Extraction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/peaks_extension.html">
     Peaks Extension
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/harmonic_spectrum.html">
     Harmonic spectrum
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/harmonic_connectivity.html">
     Harmonic connectivity
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/transitional_harmony.html">
     Transitional Harmony
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/scale_construction.html">
     Scale construction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/rhythm_construction.html">
     Rhythm construction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../../../../api/utils.html">
     Biotuner utilities
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="simple">
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../../../../_sources/_build/jupyter_execute/_build/jupyter_execute/examples/biotuner_MNE/biotuner_MNE.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Harmonicity Metrics Computation on MNE Epochs File</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="harmonicity-metrics-computation-on-mne-epochs-file">
<h1>Harmonicity Metrics Computation on MNE Epochs File<a class="headerlink" href="#harmonicity-metrics-computation-on-mne-epochs-file" title="Permalink to this headline">#</a></h1>
<p>In this notebook, we demonstrate how to compute harmonicity metrics from an MNE epochs file using the Biotuner library. Harmonicity metrics provide insights into the periodic structure of EEG signals and can be useful for various applications in neuroscience research. Biotuner is a powerful tool for extracting these metrics by analyzing the harmonic architecture of M/EEG data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary modules</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne</span> <span class="kn">import</span> <span class="n">make_fixed_length_events</span>
<span class="kn">from</span> <span class="nn">biotuner.biotuner2d</span> <span class="kn">import</span> <span class="n">biotuner_mne</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="kn">import</span> <span class="n">concatenate_raws</span><span class="p">,</span> <span class="n">read_raw_edf</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">eegbci</span>

<span class="n">raw_fnames</span> <span class="o">=</span> <span class="n">eegbci</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">raws</span> <span class="o">=</span> <span class="p">[</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">raw_fnames</span><span class="p">]</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">concatenate_raws</span><span class="p">(</span><span class="n">raws</span><span class="p">)</span>

<span class="c1"># Define the biotuner parameters</span>
<span class="n">bt_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;peaks_function&#39;</span><span class="p">:</span> <span class="s1">&#39;EMD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;fmin&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;fmax&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="s1">&#39;n_peaks&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;harm_thresh&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s1">&#39;delta_lim&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
<span class="p">}</span>


<span class="c1"># Filter the data</span>
<span class="n">raw</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">l_freq</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">h_freq</span><span class="o">=</span><span class="mf">60.</span><span class="p">)</span>

<span class="c1"># Get the names of the MEG channels</span>
<span class="n">eeg_channels</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Keep only the first 10 EEG channels</span>
<span class="n">eeg_channels</span> <span class="o">=</span> <span class="n">eeg_channels</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>

<span class="c1"># Update &#39;sf&#39; in the bt_dict</span>
<span class="n">bt_dict</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>


<span class="c1"># Epoch the data</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># start of each epoch (0s before the trigger)</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mf">5.0</span>  <span class="c1"># end of each epoch (3s after the trigger)</span>

<span class="c1"># Create events</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">make_fixed_length_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">tmax</span><span class="p">)</span>

<span class="c1"># Make sure only 3 epochs are created</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">events</span> <span class="o">=</span> <span class="n">events</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># Pick only the first 10 MEG channels</span>
<span class="n">raw</span><span class="o">.</span><span class="n">pick_channels</span><span class="p">([</span><span class="n">raw</span><span class="o">.</span><span class="n">ch_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">eeg_channels</span><span class="p">])</span>

<span class="c1"># Epoch the data</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Compute biotuner metrics on epochs file</span>
<span class="n">bt_df</span> <span class="o">=</span> <span class="n">biotuner_mne</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">bt_dict</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">savename</span><span class="o">=</span><span class="s1">&#39;multimodal_raw&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   3 out of   3 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   4 out of   4 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done  64 out of  64 | elapsed:    0.0s finished
c:\users\user\github\biotuner\biotuner\metrics.py:744: RuntimeWarning: divide by zero encountered in double_scalars
  harm_temp.append(1 / delta_norm)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bt_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>trial</th>
      <th>electrode</th>
      <th>peaks_function</th>
      <th>precision</th>
      <th>fmin</th>
      <th>fmax</th>
      <th>n_peaks</th>
      <th>harm_thresh</th>
      <th>delta_lim</th>
      <th>sf</th>
      <th>...</th>
      <th>sum_q_for_all_intervals</th>
      <th>harm_sim</th>
      <th>matrix_harm_sim</th>
      <th>matrix_cons</th>
      <th>matrix_denom</th>
      <th>cons</th>
      <th>tenney</th>
      <th>harm_fit</th>
      <th>harmsim</th>
      <th>subharm_tension</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>16.92</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.257692</td>
      <td>4.681579</td>
      <td>5</td>
      <td>16.923077</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>70</td>
      <td>25.38</td>
      <td>7.606838</td>
      <td>0.082735</td>
      <td>5.722222</td>
      <td>0.421795</td>
      <td>5.348245</td>
      <td>2</td>
      <td>25.384615</td>
      <td>[0.1523442192103758]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>112</td>
      <td>27.25</td>
      <td>6.635802</td>
      <td>0.070279</td>
      <td>6.166667</td>
      <td>0.400794</td>
      <td>5.318187</td>
      <td>2</td>
      <td>27.248677</td>
      <td>[0.0918240845268572]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>3</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>125</td>
      <td>20.03</td>
      <td>5.740630</td>
      <td>0.060683</td>
      <td>6.833333</td>
      <td>0.301120</td>
      <td>5.929879</td>
      <td>1</td>
      <td>20.028011</td>
      <td>[0.07524846423477512]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>4</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>10.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.227500</td>
      <td>5.095904</td>
      <td>5</td>
      <td>10.000000</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>5</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>40.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.700000</td>
      <td>2.214619</td>
      <td>7</td>
      <td>40.000000</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>6</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>11.18</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.240132</td>
      <td>4.831952</td>
      <td>5</td>
      <td>11.184211</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>7</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>22</td>
      <td>72.22</td>
      <td>16.666667</td>
      <td>0.196759</td>
      <td>1.888889</td>
      <td>0.583333</td>
      <td>3.056642</td>
      <td>2</td>
      <td>72.222222</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>8</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>177</td>
      <td>19.78</td>
      <td>5.256769</td>
      <td>0.056229</td>
      <td>16.277778</td>
      <td>0.267787</td>
      <td>6.144497</td>
      <td>1</td>
      <td>19.775910</td>
      <td>[0.0906806677624659]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>9</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>125</td>
      <td>20.03</td>
      <td>5.740630</td>
      <td>0.060683</td>
      <td>6.833333</td>
      <td>0.301120</td>
      <td>5.929879</td>
      <td>1</td>
      <td>20.028011</td>
      <td>[0.07524846423477512]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>0</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>97</td>
      <td>28.21</td>
      <td>10.274217</td>
      <td>0.122151</td>
      <td>5.944444</td>
      <td>0.385684</td>
      <td>5.523601</td>
      <td>1</td>
      <td>28.205128</td>
      <td>[0.07716274078164571]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1</td>
      <td>1</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>185</td>
      <td>22.67</td>
      <td>8.893519</td>
      <td>0.107685</td>
      <td>11.500000</td>
      <td>0.332222</td>
      <td>6.152546</td>
      <td>1</td>
      <td>22.666667</td>
      <td>[0.07711559117365246]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1</td>
      <td>2</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>185</td>
      <td>22.67</td>
      <td>8.893519</td>
      <td>0.107685</td>
      <td>11.500000</td>
      <td>0.332222</td>
      <td>6.152546</td>
      <td>1</td>
      <td>22.666667</td>
      <td>[0.07711559117365246]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>3</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>8.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.290000</td>
      <td>4.819212</td>
      <td>5</td>
      <td>8.000000</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1</td>
      <td>4</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>100</td>
      <td>28.00</td>
      <td>9.913580</td>
      <td>0.113313</td>
      <td>6.055556</td>
      <td>0.262222</td>
      <td>5.209187</td>
      <td>3</td>
      <td>28.000000</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1</td>
      <td>5</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>185</td>
      <td>22.67</td>
      <td>8.893519</td>
      <td>0.107685</td>
      <td>11.500000</td>
      <td>0.332222</td>
      <td>6.152546</td>
      <td>1</td>
      <td>22.666667</td>
      <td>[0.07711559117365246]</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1</td>
      <td>6</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>22</td>
      <td>31.56</td>
      <td>14.444444</td>
      <td>0.162037</td>
      <td>1.722222</td>
      <td>0.480000</td>
      <td>4.819212</td>
      <td>4</td>
      <td>31.555556</td>
      <td>[0.10191945163605978]</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>7</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>121</td>
      <td>21.61</td>
      <td>5.128205</td>
      <td>0.053550</td>
      <td>8.388889</td>
      <td>0.343101</td>
      <td>6.061838</td>
      <td>1</td>
      <td>21.611722</td>
      <td>[0.11073184664019031]</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1</td>
      <td>8</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>97</td>
      <td>28.21</td>
      <td>10.274217</td>
      <td>0.122151</td>
      <td>5.944444</td>
      <td>0.385684</td>
      <td>5.523601</td>
      <td>1</td>
      <td>28.205128</td>
      <td>[0.07716274078164571]</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>9</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>97</td>
      <td>28.21</td>
      <td>10.274217</td>
      <td>0.122151</td>
      <td>5.944444</td>
      <td>0.385684</td>
      <td>5.523601</td>
      <td>1</td>
      <td>28.205128</td>
      <td>[0.07716274078164571]</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2</td>
      <td>0</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>51</td>
      <td>60.00</td>
      <td>10.444444</td>
      <td>0.115926</td>
      <td>3.888889</td>
      <td>0.358333</td>
      <td>4.604594</td>
      <td>2</td>
      <td>60.000000</td>
      <td>[0.09038838064346723]</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2</td>
      <td>1</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>9</td>
      <td>25.00</td>
      <td>10.000000</td>
      <td>0.112500</td>
      <td>1.000000</td>
      <td>0.563333</td>
      <td>4.429237</td>
      <td>4</td>
      <td>25.000000</td>
      <td>[0.12379965876831997]</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2</td>
      <td>2</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>191</td>
      <td>13.85</td>
      <td>3.876543</td>
      <td>0.040576</td>
      <td>16.388889</td>
      <td>0.267407</td>
      <td>6.542521</td>
      <td>1</td>
      <td>13.851852</td>
      <td>[0.10316463233258048]</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2</td>
      <td>3</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>78</td>
      <td>22.35</td>
      <td>5.856209</td>
      <td>0.061961</td>
      <td>6.166667</td>
      <td>0.389216</td>
      <td>5.606261</td>
      <td>2</td>
      <td>22.352941</td>
      <td>[0.09217477598684301]</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2</td>
      <td>4</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>191</td>
      <td>13.85</td>
      <td>3.876543</td>
      <td>0.040576</td>
      <td>16.388889</td>
      <td>0.267407</td>
      <td>6.542521</td>
      <td>1</td>
      <td>13.851852</td>
      <td>[0.10316463233258048]</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2</td>
      <td>5</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>10.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.227500</td>
      <td>5.095904</td>
      <td>5</td>
      <td>10.000000</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2</td>
      <td>6</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>263</td>
      <td>26.07</td>
      <td>4.231001</td>
      <td>0.044291</td>
      <td>18.166667</td>
      <td>0.231111</td>
      <td>5.209187</td>
      <td>3</td>
      <td>26.074074</td>
      <td>[0.10553043255789613]</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2</td>
      <td>7</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>191</td>
      <td>13.85</td>
      <td>3.876543</td>
      <td>0.040576</td>
      <td>16.388889</td>
      <td>0.267407</td>
      <td>6.542521</td>
      <td>1</td>
      <td>13.851852</td>
      <td>[0.10316463233258048]</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2</td>
      <td>8</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>100</td>
      <td>28.00</td>
      <td>9.913580</td>
      <td>0.113313</td>
      <td>6.055556</td>
      <td>0.262222</td>
      <td>5.209187</td>
      <td>3</td>
      <td>28.000000</td>
      <td>[0.0]</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2</td>
      <td>9</td>
      <td>EMD</td>
      <td>0.5</td>
      <td>2</td>
      <td>60</td>
      <td>3</td>
      <td>30</td>
      <td>150</td>
      <td>160.0</td>
      <td>...</td>
      <td>192</td>
      <td>27.41</td>
      <td>5.102881</td>
      <td>0.053832</td>
      <td>15.222222</td>
      <td>0.424074</td>
      <td>4.994569</td>
      <td>4</td>
      <td>27.407407</td>
      <td>[0.07572158726508453]</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 28 columns</p>
</div></div></div>
</div>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Antoine Bellemare & François Lespinasse. This documentation and code are licensed under the <a href="https://opensource.org/licenses/MIT">MIT License</a>.<br/>
  
      &copy; Copyright 2023–2024.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>