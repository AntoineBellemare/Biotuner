{
 "cells": [
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "85bd8cac",
   "metadata": {},
   "source": [
    "## Harmonicity Metrics Computation on MNE Epochs File\n",
    "\n",
    "In this notebook, we demonstrate how to compute harmonicity metrics from an MNE epochs file using the Biotuner library. Harmonicity metrics provide insights into the periodic structure of EEG signals and can be useful for various applications in neuroscience research. Biotuner is a powerful tool for extracting these metrics by analyzing the harmonic architecture of M/EEG data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "dcd01d5a",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n",
      "[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.0s remaining:    0.0s\n",
      "[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:    0.0s remaining:    0.0s\n",
      "[Parallel(n_jobs=1)]: Done   3 out of   3 | elapsed:    0.0s remaining:    0.0s\n",
      "[Parallel(n_jobs=1)]: Done   4 out of   4 | elapsed:    0.0s remaining:    0.0s\n",
      "[Parallel(n_jobs=1)]: Done  64 out of  64 | elapsed:    0.0s finished\n",
      "c:\\users\\user\\github\\biotuner\\biotuner\\metrics.py:744: RuntimeWarning: divide by zero encountered in double_scalars\n",
      "  harm_temp.append(1 / delta_norm)\n"
     ]
    }
   ],
   "source": [
    "# Import necessary modules\n",
    "import mne\n",
    "from mne import make_fixed_length_events\n",
    "from biotuner.biotuner2d import biotuner_mne\n",
    "from mne.io import concatenate_raws, read_raw_edf\n",
    "from mne.datasets import eegbci\n",
    "\n",
    "raw_fnames = eegbci.load_data(1, 1)\n",
    "raws = [read_raw_edf(f, preload=True) for f in raw_fnames]\n",
    "raw = concatenate_raws(raws)\n",
    "\n",
    "# Define the biotuner parameters\n",
    "bt_dict = {\n",
    "    'peaks_function': 'EMD',\n",
    "    'precision': 0.5,\n",
    "    'fmin': 2,\n",
    "    'fmax': 60,\n",
    "    'n_peaks': 3,\n",
    "    'harm_thresh': 30,\n",
    "    'delta_lim': 150,\n",
    "}\n",
    "\n",
    "\n",
    "# Filter the data\n",
    "raw.filter(l_freq=2., h_freq=60.)\n",
    "\n",
    "# Get the names of the MEG channels\n",
    "eeg_channels = mne.pick_types(raw.info, eeg=True)\n",
    "\n",
    "# Keep only the first 10 EEG channels\n",
    "eeg_channels = eeg_channels[:10]\n",
    "\n",
    "# Update 'sf' in the bt_dict\n",
    "bt_dict['sf'] = raw.info['sfreq']\n",
    "\n",
    "\n",
    "# Epoch the data\n",
    "tmin = 0.0  # start of each epoch (0s before the trigger)\n",
    "tmax = 5.0  # end of each epoch (3s after the trigger)\n",
    "\n",
    "# Create events\n",
    "events = make_fixed_length_events(raw, start=0, stop=None, duration=tmax)\n",
    "\n",
    "# Make sure only 3 epochs are created\n",
    "if len(events) > 3:\n",
    "    events = events[:3]\n",
    "\n",
    "# Pick only the first 10 MEG channels\n",
    "raw.pick_channels([raw.ch_names[i] for i in eeg_channels])\n",
    "\n",
    "# Epoch the data\n",
    "epochs = mne.Epochs(raw, events, tmin=tmin, tmax=tmax, baseline=None, preload=True)\n",
    "\n",
    "# Compute biotuner metrics on epochs file\n",
    "bt_df = biotuner_mne(epochs, bt_dict, savefile=True, savename='multimodal_raw')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f462d048",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>trial</th>\n",
       "      <th>electrode</th>\n",
       "      <th>peaks_function</th>\n",
       "      <th>precision</th>\n",
       "      <th>fmin</th>\n",
       "      <th>fmax</th>\n",
       "      <th>n_peaks</th>\n",
       "      <th>harm_thresh</th>\n",
       "      <th>delta_lim</th>\n",
       "      <th>sf</th>\n",
       "      <th>...</th>\n",
       "      <th>sum_q_for_all_intervals</th>\n",
       "      <th>harm_sim</th>\n",
       "      <th>matrix_harm_sim</th>\n",
       "      <th>matrix_cons</th>\n",
       "      <th>matrix_denom</th>\n",
       "      <th>cons</th>\n",
       "      <th>tenney</th>\n",
       "      <th>harm_fit</th>\n",
       "      <th>harmsim</th>\n",
       "      <th>subharm_tension</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.92</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.257692</td>\n",
       "      <td>4.681579</td>\n",
       "      <td>5</td>\n",
       "      <td>16.923077</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>70</td>\n",
       "      <td>25.38</td>\n",
       "      <td>7.606838</td>\n",
       "      <td>0.082735</td>\n",
       "      <td>5.722222</td>\n",
       "      <td>0.421795</td>\n",
       "      <td>5.348245</td>\n",
       "      <td>2</td>\n",
       "      <td>25.384615</td>\n",
       "      <td>[0.1523442192103758]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>112</td>\n",
       "      <td>27.25</td>\n",
       "      <td>6.635802</td>\n",
       "      <td>0.070279</td>\n",
       "      <td>6.166667</td>\n",
       "      <td>0.400794</td>\n",
       "      <td>5.318187</td>\n",
       "      <td>2</td>\n",
       "      <td>27.248677</td>\n",
       "      <td>[0.0918240845268572]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>125</td>\n",
       "      <td>20.03</td>\n",
       "      <td>5.740630</td>\n",
       "      <td>0.060683</td>\n",
       "      <td>6.833333</td>\n",
       "      <td>0.301120</td>\n",
       "      <td>5.929879</td>\n",
       "      <td>1</td>\n",
       "      <td>20.028011</td>\n",
       "      <td>[0.07524846423477512]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.227500</td>\n",
       "      <td>5.095904</td>\n",
       "      <td>5</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>40.00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.700000</td>\n",
       "      <td>2.214619</td>\n",
       "      <td>7</td>\n",
       "      <td>40.000000</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.18</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.240132</td>\n",
       "      <td>4.831952</td>\n",
       "      <td>5</td>\n",
       "      <td>11.184211</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>22</td>\n",
       "      <td>72.22</td>\n",
       "      <td>16.666667</td>\n",
       "      <td>0.196759</td>\n",
       "      <td>1.888889</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>3.056642</td>\n",
       "      <td>2</td>\n",
       "      <td>72.222222</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>177</td>\n",
       "      <td>19.78</td>\n",
       "      <td>5.256769</td>\n",
       "      <td>0.056229</td>\n",
       "      <td>16.277778</td>\n",
       "      <td>0.267787</td>\n",
       "      <td>6.144497</td>\n",
       "      <td>1</td>\n",
       "      <td>19.775910</td>\n",
       "      <td>[0.0906806677624659]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>125</td>\n",
       "      <td>20.03</td>\n",
       "      <td>5.740630</td>\n",
       "      <td>0.060683</td>\n",
       "      <td>6.833333</td>\n",
       "      <td>0.301120</td>\n",
       "      <td>5.929879</td>\n",
       "      <td>1</td>\n",
       "      <td>20.028011</td>\n",
       "      <td>[0.07524846423477512]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>97</td>\n",
       "      <td>28.21</td>\n",
       "      <td>10.274217</td>\n",
       "      <td>0.122151</td>\n",
       "      <td>5.944444</td>\n",
       "      <td>0.385684</td>\n",
       "      <td>5.523601</td>\n",
       "      <td>1</td>\n",
       "      <td>28.205128</td>\n",
       "      <td>[0.07716274078164571]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>185</td>\n",
       "      <td>22.67</td>\n",
       "      <td>8.893519</td>\n",
       "      <td>0.107685</td>\n",
       "      <td>11.500000</td>\n",
       "      <td>0.332222</td>\n",
       "      <td>6.152546</td>\n",
       "      <td>1</td>\n",
       "      <td>22.666667</td>\n",
       "      <td>[0.07711559117365246]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>185</td>\n",
       "      <td>22.67</td>\n",
       "      <td>8.893519</td>\n",
       "      <td>0.107685</td>\n",
       "      <td>11.500000</td>\n",
       "      <td>0.332222</td>\n",
       "      <td>6.152546</td>\n",
       "      <td>1</td>\n",
       "      <td>22.666667</td>\n",
       "      <td>[0.07711559117365246]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.290000</td>\n",
       "      <td>4.819212</td>\n",
       "      <td>5</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>100</td>\n",
       "      <td>28.00</td>\n",
       "      <td>9.913580</td>\n",
       "      <td>0.113313</td>\n",
       "      <td>6.055556</td>\n",
       "      <td>0.262222</td>\n",
       "      <td>5.209187</td>\n",
       "      <td>3</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>185</td>\n",
       "      <td>22.67</td>\n",
       "      <td>8.893519</td>\n",
       "      <td>0.107685</td>\n",
       "      <td>11.500000</td>\n",
       "      <td>0.332222</td>\n",
       "      <td>6.152546</td>\n",
       "      <td>1</td>\n",
       "      <td>22.666667</td>\n",
       "      <td>[0.07711559117365246]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>22</td>\n",
       "      <td>31.56</td>\n",
       "      <td>14.444444</td>\n",
       "      <td>0.162037</td>\n",
       "      <td>1.722222</td>\n",
       "      <td>0.480000</td>\n",
       "      <td>4.819212</td>\n",
       "      <td>4</td>\n",
       "      <td>31.555556</td>\n",
       "      <td>[0.10191945163605978]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>121</td>\n",
       "      <td>21.61</td>\n",
       "      <td>5.128205</td>\n",
       "      <td>0.053550</td>\n",
       "      <td>8.388889</td>\n",
       "      <td>0.343101</td>\n",
       "      <td>6.061838</td>\n",
       "      <td>1</td>\n",
       "      <td>21.611722</td>\n",
       "      <td>[0.11073184664019031]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>97</td>\n",
       "      <td>28.21</td>\n",
       "      <td>10.274217</td>\n",
       "      <td>0.122151</td>\n",
       "      <td>5.944444</td>\n",
       "      <td>0.385684</td>\n",
       "      <td>5.523601</td>\n",
       "      <td>1</td>\n",
       "      <td>28.205128</td>\n",
       "      <td>[0.07716274078164571]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>97</td>\n",
       "      <td>28.21</td>\n",
       "      <td>10.274217</td>\n",
       "      <td>0.122151</td>\n",
       "      <td>5.944444</td>\n",
       "      <td>0.385684</td>\n",
       "      <td>5.523601</td>\n",
       "      <td>1</td>\n",
       "      <td>28.205128</td>\n",
       "      <td>[0.07716274078164571]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>51</td>\n",
       "      <td>60.00</td>\n",
       "      <td>10.444444</td>\n",
       "      <td>0.115926</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>0.358333</td>\n",
       "      <td>4.604594</td>\n",
       "      <td>2</td>\n",
       "      <td>60.000000</td>\n",
       "      <td>[0.09038838064346723]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>9</td>\n",
       "      <td>25.00</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>0.112500</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.563333</td>\n",
       "      <td>4.429237</td>\n",
       "      <td>4</td>\n",
       "      <td>25.000000</td>\n",
       "      <td>[0.12379965876831997]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>191</td>\n",
       "      <td>13.85</td>\n",
       "      <td>3.876543</td>\n",
       "      <td>0.040576</td>\n",
       "      <td>16.388889</td>\n",
       "      <td>0.267407</td>\n",
       "      <td>6.542521</td>\n",
       "      <td>1</td>\n",
       "      <td>13.851852</td>\n",
       "      <td>[0.10316463233258048]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>78</td>\n",
       "      <td>22.35</td>\n",
       "      <td>5.856209</td>\n",
       "      <td>0.061961</td>\n",
       "      <td>6.166667</td>\n",
       "      <td>0.389216</td>\n",
       "      <td>5.606261</td>\n",
       "      <td>2</td>\n",
       "      <td>22.352941</td>\n",
       "      <td>[0.09217477598684301]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>191</td>\n",
       "      <td>13.85</td>\n",
       "      <td>3.876543</td>\n",
       "      <td>0.040576</td>\n",
       "      <td>16.388889</td>\n",
       "      <td>0.267407</td>\n",
       "      <td>6.542521</td>\n",
       "      <td>1</td>\n",
       "      <td>13.851852</td>\n",
       "      <td>[0.10316463233258048]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.227500</td>\n",
       "      <td>5.095904</td>\n",
       "      <td>5</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>263</td>\n",
       "      <td>26.07</td>\n",
       "      <td>4.231001</td>\n",
       "      <td>0.044291</td>\n",
       "      <td>18.166667</td>\n",
       "      <td>0.231111</td>\n",
       "      <td>5.209187</td>\n",
       "      <td>3</td>\n",
       "      <td>26.074074</td>\n",
       "      <td>[0.10553043255789613]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>191</td>\n",
       "      <td>13.85</td>\n",
       "      <td>3.876543</td>\n",
       "      <td>0.040576</td>\n",
       "      <td>16.388889</td>\n",
       "      <td>0.267407</td>\n",
       "      <td>6.542521</td>\n",
       "      <td>1</td>\n",
       "      <td>13.851852</td>\n",
       "      <td>[0.10316463233258048]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>100</td>\n",
       "      <td>28.00</td>\n",
       "      <td>9.913580</td>\n",
       "      <td>0.113313</td>\n",
       "      <td>6.055556</td>\n",
       "      <td>0.262222</td>\n",
       "      <td>5.209187</td>\n",
       "      <td>3</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>[0.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>EMD</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>30</td>\n",
       "      <td>150</td>\n",
       "      <td>160.0</td>\n",
       "      <td>...</td>\n",
       "      <td>192</td>\n",
       "      <td>27.41</td>\n",
       "      <td>5.102881</td>\n",
       "      <td>0.053832</td>\n",
       "      <td>15.222222</td>\n",
       "      <td>0.424074</td>\n",
       "      <td>4.994569</td>\n",
       "      <td>4</td>\n",
       "      <td>27.407407</td>\n",
       "      <td>[0.07572158726508453]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>30 rows × 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    trial  electrode peaks_function  precision  fmin  fmax  n_peaks  \\\n",
       "0       0          0            EMD        0.5     2    60        3   \n",
       "1       0          1            EMD        0.5     2    60        3   \n",
       "2       0          2            EMD        0.5     2    60        3   \n",
       "3       0          3            EMD        0.5     2    60        3   \n",
       "4       0          4            EMD        0.5     2    60        3   \n",
       "5       0          5            EMD        0.5     2    60        3   \n",
       "6       0          6            EMD        0.5     2    60        3   \n",
       "7       0          7            EMD        0.5     2    60        3   \n",
       "8       0          8            EMD        0.5     2    60        3   \n",
       "9       0          9            EMD        0.5     2    60        3   \n",
       "10      1          0            EMD        0.5     2    60        3   \n",
       "11      1          1            EMD        0.5     2    60        3   \n",
       "12      1          2            EMD        0.5     2    60        3   \n",
       "13      1          3            EMD        0.5     2    60        3   \n",
       "14      1          4            EMD        0.5     2    60        3   \n",
       "15      1          5            EMD        0.5     2    60        3   \n",
       "16      1          6            EMD        0.5     2    60        3   \n",
       "17      1          7            EMD        0.5     2    60        3   \n",
       "18      1          8            EMD        0.5     2    60        3   \n",
       "19      1          9            EMD        0.5     2    60        3   \n",
       "20      2          0            EMD        0.5     2    60        3   \n",
       "21      2          1            EMD        0.5     2    60        3   \n",
       "22      2          2            EMD        0.5     2    60        3   \n",
       "23      2          3            EMD        0.5     2    60        3   \n",
       "24      2          4            EMD        0.5     2    60        3   \n",
       "25      2          5            EMD        0.5     2    60        3   \n",
       "26      2          6            EMD        0.5     2    60        3   \n",
       "27      2          7            EMD        0.5     2    60        3   \n",
       "28      2          8            EMD        0.5     2    60        3   \n",
       "29      2          9            EMD        0.5     2    60        3   \n",
       "\n",
       "    harm_thresh  delta_lim     sf  ...  sum_q_for_all_intervals  harm_sim  \\\n",
       "0            30        150  160.0  ...                      0.0     16.92   \n",
       "1            30        150  160.0  ...                       70     25.38   \n",
       "2            30        150  160.0  ...                      112     27.25   \n",
       "3            30        150  160.0  ...                      125     20.03   \n",
       "4            30        150  160.0  ...                      0.0     10.00   \n",
       "5            30        150  160.0  ...                      0.0     40.00   \n",
       "6            30        150  160.0  ...                      0.0     11.18   \n",
       "7            30        150  160.0  ...                       22     72.22   \n",
       "8            30        150  160.0  ...                      177     19.78   \n",
       "9            30        150  160.0  ...                      125     20.03   \n",
       "10           30        150  160.0  ...                       97     28.21   \n",
       "11           30        150  160.0  ...                      185     22.67   \n",
       "12           30        150  160.0  ...                      185     22.67   \n",
       "13           30        150  160.0  ...                      0.0      8.00   \n",
       "14           30        150  160.0  ...                      100     28.00   \n",
       "15           30        150  160.0  ...                      185     22.67   \n",
       "16           30        150  160.0  ...                       22     31.56   \n",
       "17           30        150  160.0  ...                      121     21.61   \n",
       "18           30        150  160.0  ...                       97     28.21   \n",
       "19           30        150  160.0  ...                       97     28.21   \n",
       "20           30        150  160.0  ...                       51     60.00   \n",
       "21           30        150  160.0  ...                        9     25.00   \n",
       "22           30        150  160.0  ...                      191     13.85   \n",
       "23           30        150  160.0  ...                       78     22.35   \n",
       "24           30        150  160.0  ...                      191     13.85   \n",
       "25           30        150  160.0  ...                      0.0     10.00   \n",
       "26           30        150  160.0  ...                      263     26.07   \n",
       "27           30        150  160.0  ...                      191     13.85   \n",
       "28           30        150  160.0  ...                      100     28.00   \n",
       "29           30        150  160.0  ...                      192     27.41   \n",
       "\n",
       "    matrix_harm_sim  matrix_cons  matrix_denom      cons    tenney  harm_fit  \\\n",
       "0          0.000000     0.000000      0.000000  0.257692  4.681579         5   \n",
       "1          7.606838     0.082735      5.722222  0.421795  5.348245         2   \n",
       "2          6.635802     0.070279      6.166667  0.400794  5.318187         2   \n",
       "3          5.740630     0.060683      6.833333  0.301120  5.929879         1   \n",
       "4          0.000000     0.000000      0.000000  0.227500  5.095904         5   \n",
       "5          0.000000     0.000000      0.000000  0.700000  2.214619         7   \n",
       "6          0.000000     0.000000      0.000000  0.240132  4.831952         5   \n",
       "7         16.666667     0.196759      1.888889  0.583333  3.056642         2   \n",
       "8          5.256769     0.056229     16.277778  0.267787  6.144497         1   \n",
       "9          5.740630     0.060683      6.833333  0.301120  5.929879         1   \n",
       "10        10.274217     0.122151      5.944444  0.385684  5.523601         1   \n",
       "11         8.893519     0.107685     11.500000  0.332222  6.152546         1   \n",
       "12         8.893519     0.107685     11.500000  0.332222  6.152546         1   \n",
       "13         0.000000     0.000000      0.000000  0.290000  4.819212         5   \n",
       "14         9.913580     0.113313      6.055556  0.262222  5.209187         3   \n",
       "15         8.893519     0.107685     11.500000  0.332222  6.152546         1   \n",
       "16        14.444444     0.162037      1.722222  0.480000  4.819212         4   \n",
       "17         5.128205     0.053550      8.388889  0.343101  6.061838         1   \n",
       "18        10.274217     0.122151      5.944444  0.385684  5.523601         1   \n",
       "19        10.274217     0.122151      5.944444  0.385684  5.523601         1   \n",
       "20        10.444444     0.115926      3.888889  0.358333  4.604594         2   \n",
       "21        10.000000     0.112500      1.000000  0.563333  4.429237         4   \n",
       "22         3.876543     0.040576     16.388889  0.267407  6.542521         1   \n",
       "23         5.856209     0.061961      6.166667  0.389216  5.606261         2   \n",
       "24         3.876543     0.040576     16.388889  0.267407  6.542521         1   \n",
       "25         0.000000     0.000000      0.000000  0.227500  5.095904         5   \n",
       "26         4.231001     0.044291     18.166667  0.231111  5.209187         3   \n",
       "27         3.876543     0.040576     16.388889  0.267407  6.542521         1   \n",
       "28         9.913580     0.113313      6.055556  0.262222  5.209187         3   \n",
       "29         5.102881     0.053832     15.222222  0.424074  4.994569         4   \n",
       "\n",
       "      harmsim        subharm_tension  \n",
       "0   16.923077                  [0.0]  \n",
       "1   25.384615   [0.1523442192103758]  \n",
       "2   27.248677   [0.0918240845268572]  \n",
       "3   20.028011  [0.07524846423477512]  \n",
       "4   10.000000                  [0.0]  \n",
       "5   40.000000                  [0.0]  \n",
       "6   11.184211                  [0.0]  \n",
       "7   72.222222                    NaN  \n",
       "8   19.775910   [0.0906806677624659]  \n",
       "9   20.028011  [0.07524846423477512]  \n",
       "10  28.205128  [0.07716274078164571]  \n",
       "11  22.666667  [0.07711559117365246]  \n",
       "12  22.666667  [0.07711559117365246]  \n",
       "13   8.000000                  [0.0]  \n",
       "14  28.000000                  [0.0]  \n",
       "15  22.666667  [0.07711559117365246]  \n",
       "16  31.555556  [0.10191945163605978]  \n",
       "17  21.611722  [0.11073184664019031]  \n",
       "18  28.205128  [0.07716274078164571]  \n",
       "19  28.205128  [0.07716274078164571]  \n",
       "20  60.000000  [0.09038838064346723]  \n",
       "21  25.000000  [0.12379965876831997]  \n",
       "22  13.851852  [0.10316463233258048]  \n",
       "23  22.352941  [0.09217477598684301]  \n",
       "24  13.851852  [0.10316463233258048]  \n",
       "25  10.000000                  [0.0]  \n",
       "26  26.074074  [0.10553043255789613]  \n",
       "27  13.851852  [0.10316463233258048]  \n",
       "28  28.000000                  [0.0]  \n",
       "29  27.407407  [0.07572158726508453]  \n",
       "\n",
       "[30 rows x 28 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bt_df"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "biotuner",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.15"
  },
  "vscode": {
   "interpreter": {
    "hash": "78920748c27eb6b6a66039cd6eaf38ba7b9251be5db3fee90bd349c5848cd2ed"
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}